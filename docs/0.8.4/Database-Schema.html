<html lang="en">
<head>
<title>Database Schema - BuildBot Manual - 0.8.4</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="BuildBot Manual - 0.8.4">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="The-Database.html#The-Database" title="The Database">
<link rel="next" href="Changing-the-Schema.html#Changing-the-Schema" title="Changing the Schema">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This is the BuildBot manual for Buildbot version 0.8.4.

Copyright (C) 2005, 2006, 2009, 2010 Brian Warner

Copying and distribution of this file, with or without
modification, are permitted in any medium without royalty
provided the copyright notice and this notice are preserved.-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
<!-- GA-TRACKING-START -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker("UA-12313843-4");
pageTracker._setDomainName("none");
pageTracker._setAllowLinker(true);
pageTracker._trackPageview();
} catch(err) {}
</script>
<!-- GA-TRACKING-END -->
</head>
<body>
<div class="node">
<a name="Database-Schema"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Changing-the-Schema.html#Changing-the-Schema">Changing the Schema</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="The-Database.html#The-Database">The Database</a>
<hr>
</div>

<h4 class="subsection">8.4.1 Database Schema</h4>

<p><a name="index-buildbot_002edb_002eschema_002eDBSchemaManager-162"></a>
The SQL for the database schema is available in
<code>buildbot/db/schema/tables.sql</code>.  However, note that this file is not used
for new installations or upgrades of the Buildbot database.

   <p>Instead, the <code>buildbot.db.schema.DBSchemaManager</code> handles this task.  The
operation of this class centers around a linear sequence of database versions. 
Versions start at 0, which is the old pickle-file format.  The manager has
methods to query the version of the database, and the current version from the
source code.  It also has an <code>upgrade</code> method which will upgrade the
database to the latest version.  This operation is currently irreversible.

   <p>There is no operation to "install" the latest schema.  Instead, a fresh install
of buildbot begins with an (empty) version-0 database, and upgrades to the
current version.  This trades a bit of efficiency at install time for
assurances that the upgrade code is well-tested.

   </body></html>

